.well.charge-item{class: "merchant-#{charge.descriptor.downcase.gsub(/\W/, '')}", id: "charge-item-#{charge.id.present? ? charge.id : 'new'}" }
  -if current_user.admin
    .text-center{style: "margin-bottom: -10px; margin-top: -10px;"}
      %small=link_to "admin feedback", admin_charge_path(charge)
  
  .charge-info-container
    .charge-info.charge-amount.text-center{style: "padding-right: 10px;"}
      %p.lead.without-margin
        -if charge.amount.present? && charge.amount > 0
          =number_to_currency(charge.amount_in_currency)
        -else 
          %i.fa.fa-exclamation-circle
          $
      %p.without-margin
        -if charge.renewal_period_in_weeks.present? && charge.renewal_period_in_weeks > 0
          =billing_interval_in_words(charge.renewal_period_in_weeks)
        -else
          %i.fa.fa-exclamation-circle
          ???
      -if charge.history.present?
        .small
          %a.icon-link{tabindex: "0", data: {toggle: "popover", content: formatted_history(charge.history)} }
            %i.fa.fa-calendar
            history
              
    .charge-info.charge-description    
    
      %p.lead.without-margin
        -if charge.merchant.present? && charge.merchant.name.present?
          =charge.merchant.name
        -else
          Merchant Unknown
      %p.without-margin.small
        %span.small-gray
          -if charge.next_billing_date.present?
            %i.fa.fa-clock-o.hidden-md
            =time_to_next_bill(charge.next_billing_date)
          -elsif charge.billing_day.present?
            %i.fa.fa-clock-o.hidden-md
            ="last charge " + (distance_of_time_in_words charge.billing_day.to_time - Time.now) + " ago"
          -else
            %i.fa.fa-exclamation-circle
            ???
      %p.without-margin
        =charge.smart_description
    .charge-info.charge-buttons.text-center
      -if stop_order_charge_ids.include?(charge.id)
        =render partial: "stop_orders/show", locals: {stop_order: charge.active_stop_order}

      -else        
        .inline-block.charge-item-action-buttons
          -unless controller_name == "charges" && request.format.html? && action_name != 'list_all'
            .checkbox.without-margin
              %label
                %input{ type: "checkbox", name: "track-switch", checked: charge.recurring, data: { charge_id: charge.id } }
                  %small.strong{style: "margin-left: -3px;"} Track?
            %small
              =link_to "delete", {controller: "charges", action: "destroy", id: charge.id}, method: :delete, class: "btn btn-xs btn-default", style: "margin-top: 5px; color: gray;", data: {confirm: "Are you sure you want to delete this charge? This can't be undone."}, remote: true
          -else
            =link_to new_charge_stop_order_path(charge), remote: true, class: "btn btn-primary btn-xs" do
              %small
                .text-center
                  MANAGE 
                .text-center
                  SUBSCRIPTION
            =link_to "edit info", edit_charge_path(charge), class: "btn btn-xs btn-default", style: "margin-top: 5px; color: gray;", remote: true